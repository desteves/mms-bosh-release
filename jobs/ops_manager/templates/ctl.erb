#!/bin/bash

 RUN_DIR=/var/vcap/sys/run/ops_manager
 LOG_DIR=/var/vcap/sys/log/ops_manager
 PIDFILE=${RUN_DIR}/pid
 OPS_DIR=/var/vcap/store/ops_manager

 case $1 in

   start)
     mkdir -p $RUN_DIR $LOG_DIR $OPS_DIR
     chown -R vcap:vcap $RUN_DIR $LOG_DIR $OPS_DIR
     echo $$ > $PIDFILE
     ###  "Jobs never depend on other jobs." @http://bosh.io/docs/create-release.html
     ### /gif angry
     ### Conclusion: Relying on PreFlight Checks by mongodb-mms and monit retry attempts
     exec /var/vcap/packages/ops_manager/bin/mongodb-mms start
     ;;

   stop)
     /var/vcap/packages/ops_manager/bin/mongodb-mms stop
     rm -f $PIDFILE
     ;;

   *)
     echo "Usage: ctl {start|stop}" ;;

 esac
